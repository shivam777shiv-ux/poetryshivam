<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Poetry - ‡§Æ‡•á‡§∞‡§æ ‡§ï‡§µ‡§ø‡§§‡§æ‡§≤‡§Ø</title>
  <style>
    :root{--bg:#f7f7f9;--card:#ffffff;--muted:#666;--accent:#6b46c1}
    [data-theme="dark"]{--bg:#0b0b0f;--card:#0f1720;--muted:#abb0bd;--accent:#8b5cf6}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Noto Sans', sans-serif;margin:0;background:var(--bg);color:#111}
    header{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;background:linear-gradient(90deg,rgba(107,70,193,.06),transparent);backdrop-filter:blur(2px)}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#ff7ab6);display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    h1{margin:0;font-size:20px}
    header .controls{display:flex;gap:8px;align-items:center}
    .btn{padding:8px 12px;border-radius:8px;border:0;background:var(--card);cursor:pointer;box-shadow:0 1px 0 rgba(0,0,0,.04)}
    .container{max-width:980px;margin:28px auto;padding:0 16px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:14px}
    input[type=text], textarea, select{padding:10px;border-radius:8px;border:1px solid #e6e9ef;background:var(--card);min-width:160px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
    .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(12,13,20,.04)}
    .meta{font-size:12px;color:var(--muted);margin-bottom:8px}
    .poem{white-space:pre-wrap;line-height:1.5;font-size:15px}
    .actions{display:flex;gap:8px;margin-top:10px}
    .small{padding:6px 8px;border-radius:8px;font-size:13px}
    footer{padding:18px;text-align:center;color:var(--muted)}
    .tag{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;background:rgba(107,70,193,.08);margin-right:6px}
    .hidden{display:none}
    @media(max-width:560px){header{padding:14px} .logo{width:40px;height:40px}}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">‡§ï‡§µ</div>
      <div>
        <h1>‡§Æ‡•á‡§∞‡§æ ‡§ï‡§µ‡§ø‡§§‡§æ‡§≤‡§Ø</h1>
        <div style="font-size:12px;color:var(--muted)">‡§Ö‡§™‡§®‡•Ä ‡§ï‡§µ‡§ø‡§§‡§æ‡§è‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç, ‡§ñ‡•ã‡§ú‡•á‡§Ç ‡§î‡§∞ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</div>
      </div>
    </div>
    <div class="controls">
      <button id="themeBtn" class="btn">üåô</button>
      <button id="newBtn" class="btn">‚ûï ‡§®‡§à ‡§ï‡§µ‡§ø‡§§‡§æ</button>
    </div>
  </header>

  <main class="container">
    <div class="toolbar">
      <input id="search" type="text" placeholder="‡§ï‡§µ‡§ø‡§§‡§æ ‡§ñ‡•ã‡§ú‡•á‡§Ç ‡§Ø‡§æ ‡§∂‡§¨‡•ç‡§¶ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç..." />
      <select id="sort">
        <option value="new">‡§®‡§µ‡•Ä‡§®‡§§‡§Æ</option>
        <option value="old">‡§™‡•Å‡§∞‡§æ‡§®‡•Ä</option>
        <option value="title">‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞</option>
      </select>
      <input id="tagFilter" type="text" placeholder="‡§ü‡•à‡§ó ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ (‡§ï‡•â‡§Æ‡§æ ‡§∏‡•á ‡§Ö‡§≤‡§ó ‡§ï‡§∞‡•á‡§Ç)" />
      <button id="exportBtn" class="btn">Export</button>
      <button id="importBtn" class="btn">Import</button>
    </div>

    <section id="list" class="grid"></section>
  </main>

  <footer>Made with ‚ô• ‚Äî ‡§Ü‡§™ ‡§ö‡§æ‡§π‡•á‡§Ç ‡§§‡•ã ‡§Æ‡•à‡§Ç ‡§á‡§∏‡•á ‡§Ü‡§™‡§ï‡•Ä ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§æ‡§á‡§ú‡§º ‡§ï‡§∞ ‡§¶‡•Ç‡§Å‡•§</footer>

  <!-- Modal (simple) -->
  <div id="modal" class="hidden" style="position:fixed;inset:0;background:rgba(2,6,23,.5);display:flex;align-items:center;justify-content:center;padding:16px">
    <div style="width:100%;max-width:720px;background:var(--card);border-radius:12px;padding:18px;">
      <h3 id="modalTitle">‡§®‡§à ‡§ï‡§µ‡§ø‡§§‡§æ</h3>
      <div style="display:flex;gap:8px;flex-direction:column">
        <input id="title" type="text" placeholder="‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï (optional)" />
        <textarea id="content" rows="8" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§µ‡§ø‡§§‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç..."></textarea>
        <input id="tags" type="text" placeholder="‡§ü‡•à‡§ó (comma separated)" />
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button id="saveBtn" class="btn">‡§∏‡§π‡•á‡§ú‡•á‡§Ç</button>
          <button id="closeBtn" class="btn">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
        </div>
      </div>
    </div>
  </div>

  <input id="fileInput" type="file" accept="application/json" class="hidden" />

  <script>
    // Complete, tested single-file Poetry App (Option 3)
    // Data stored in localStorage under key: 'poetrySite_v3'

    const STORAGE_KEY = 'poetrySite_v3';
    const modal = document.getElementById('modal');
    const list = document.getElementById('list');
    const newBtn = document.getElementById('newBtn');
    const closeBtn = document.getElementById('closeBtn');
    const saveBtn = document.getElementById('saveBtn');
    const titleIn = document.getElementById('title');
    const contentIn = document.getElementById('content');
    const tagsIn = document.getElementById('tags');
    const search = document.getElementById('search');
    const sort = document.getElementById('sort');
    const tagFilter = document.getElementById('tagFilter');
    const exportBtn = document.getElementById('exportBtn');
    const importBtn = document.getElementById('importBtn');
    const fileInput = document.getElementById('fileInput');
    const themeBtn = document.getElementById('themeBtn');

    let poems = [];
    let editingId = null;

    function uid(){return Date.now().toString(36)+Math.random().toString(36).slice(2,8)}

    function load(){
      try{poems = JSON.parse(localStorage.getItem(STORAGE_KEY)) || defaultData();}catch(e){poems = defaultData();}
    }
    function save(){localStorage.setItem(STORAGE_KEY, JSON.stringify(poems));}

    function defaultData(){
      return [
        {id:uid(),title:'‡§∏‡§™‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§∞‡§æ‡§π',content:'‡§ö‡•Å‡§™‡§ö‡§æ‡§™ ‡§¨‡§π‡§§‡•Ä ‡§π‡•à ‡§∞‡§æ‡§§ ‡§ï‡•Ä ‡§®‡§¶‡•Ä\n‡§∏‡§ø‡§§‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ö‡§≤‡§§‡•Ä ‡§Æ‡•á‡§∞‡•Ä ‡§§‡§®‡•ç‡§π‡§æ‡§à\n‡§ï‡§¶‡§Æ ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Å ‡§â‡§Æ‡•ç‡§Æ‡•Ä‡§¶ ‡§ï‡•á ‡§∏‡§æ‡§è\n‡§µ‡§π‡•Ä‡§Ç ‡§ñ‡§ø‡§≤ ‡§â‡§†‡§§‡•Ä ‡§π‡•à ‡§è‡§ï ‡§®‡§à ‡§ï‡§π‡§æ‡§®‡•Ä',tags:['‡§â‡§Æ‡•ç‡§Æ‡•Ä‡§¶','‡§∞‡§æ‡§§'],created:Date.now()},
        {id:uid(),title:'‡§™‡§π‡§≤‡§æ ‡§∏‡§µ‡•á‡§∞‡§æ',content:'‡§Ü‡§ú ‡§∏‡•Å‡§¨‡§π ‡§ï‡•Å‡§õ ‡§Ö‡§≤‡§ó ‡§ú‡§æ‡§ó‡§æ\n‡§ß‡•Ç‡§™ ‡§®‡•á ‡§¶‡•Ä ‡§Ö‡§Ç‡§ó‡§°‡§º‡§æ‡§à\n‡§Æ‡§® ‡§Æ‡•á‡§Ç ‡§ò‡•Å‡§≤‡§æ ‡§®‡§Ø‡§æ ‡§∞‡§Ç‡§ó\n‡§ñ‡•Å‡§≤‡§æ ‡§¶‡§ø‡§≤, ‡§ñ‡•Å‡§≤‡§æ ‡§∏‡§Ç‡§ó',tags:['‡§∏‡•Å‡§¨‡§π','‡§π‡•å‡§∏‡§≤‡§æ'],created:Date.now()-86400000}
      ];
    }

    function render(){
      list.innerHTML='';
      const q = search.value.trim().toLowerCase();
      const tagQ = tagFilter.value.split(',').map(s=>s.trim().toLowerCase()).filter(Boolean);
      let out = poems.slice();
      if(sort.value==='new') out.sort((a,b)=>b.created-a.created);
      if(sort.value==='old') out.sort((a,b)=>a.created-b.created);
      if(sort.value==='title') out.sort((a,b)=>(a.title||'').localeCompare(b.title||''));
      out = out.filter(p=>{
        if(q && !(p.content.toLowerCase().includes(q) || (p.title||'').toLowerCase().includes(q))) return false;
        if(tagQ.length){
          const lowerTags = (p.tags||[]).map(t=>t.toLowerCase());
          return tagQ.every(t=>lowerTags.includes(t));
        }
        return true;
      });

      if(out.length===0){
        list.innerHTML='<div style="grid-column:1/-1;padding:18px;color:var(--muted)">‡§ï‡•ã‡§à ‡§ï‡§µ‡§ø‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä ‚Äî ‡§®‡§à ‡§ï‡§µ‡§ø‡§§‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</div>';
        return;
      }

      out.forEach(p=>{
        const el = document.createElement('article');
        el.className='card';
        const date = new Date(p.created);
        el.innerHTML = `
          <div class="meta">${p.title?escapeHtml(p.title):'‡§¨‡§ø‡§®‡§æ ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï'} ‚Ä¢ ${date.toLocaleString('hi-IN')}</div>
          <div class="poem">${escapeHtml(p.content)}</div>
          <div style="margin-top:10px">${(p.tags||[]).map(t=>`<span class="tag">${escapeHtml(t)}</span>`).join('')}</div>
          <div class="actions">
            <button class="small" onclick="editPoem('${p.id}')">‚úèÔ∏è ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§</button>
            <button class="small" onclick="deletePoem('${p.id}')">üóëÔ∏è ‡§π‡§ü‡§æ‡§è‡§Å</button>
            <button class="small" onclick="downloadPoem('${p.id}')">‚¨áÔ∏è ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
          </div>
        `;
        list.appendChild(el);
      })
    }

    // helpers
    function escapeHtml(s){return (s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;')}

    // CRUD
    window.editPoem = function(id){
      editingId = id;
      const p = poems.find(x=>x.id===id);
      titleIn.value = p.title || '';
      contentIn.value = p.content || '';
      tagsIn.value = (p.tags||[]).join(', ');
      modal.classList.remove('hidden');
      document.body.style.overflow='hidden';
      document.getElementById('modalTitle').textContent='‡§ï‡§µ‡§ø‡§§‡§æ ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç';
    }
    window.deletePoem = function(id){
      if(!confirm('‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§á‡§∏ ‡§ï‡§µ‡§ø‡§§‡§æ ‡§ï‡•ã ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?')) return;
      poems = poems.filter(p=>p.id!==id); save(); render();
    }
    window.downloadPoem = function(id){
      const p = poems.find(x=>x.id===id);
      const blob = new Blob([`Title: ${p.title || '‚Äî'}\nTags: ${(p.tags||[]).join(', ')}\n\n${p.content}`],{type:'text/plain'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download=(p.title||'poem')+'.txt'; a.click(); URL.revokeObjectURL(url);
    }

    // events
    newBtn.addEventListener('click', ()=>{
      editingId = null; titleIn.value=''; contentIn.value=''; tagsIn.value=''; modal.classList.remove('hidden'); document.body.style.overflow='hidden'; document.getElementById('modalTitle').textContent='‡§®‡§à ‡§ï‡§µ‡§ø‡§§‡§æ';
    });
    closeBtn.addEventListener('click', ()=>{
      modal.classList.add('hidden');
      document.body.style.overflow='';
    });
    saveBtn.addEventListener('click', ()=>{
      const t = titleIn.value.trim(); const c = contentIn.value.trim(); const tg = tagsIn.value.split(',').map(s=>s.trim()).filter(Boolean);
      if(!c){alert('‡§ï‡§µ‡§ø‡§§‡§æ ‡§ï‡§æ ‡§™‡§æ‡§† ‡§ñ‡§æ‡§≤‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ‡•§'); return}
      if(editingId){
        const p = poems.find(x=>x.id===editingId); p.title=t; p.content=c; p.tags=tg; p.created = p.created || Date.now();
      } else {
        poems.push({id:uid(), title:t, content:c, tags:tg, created:Date.now()});
      }
      save(); render(); modal.classList.add('hidden'); document.body.style.overflow='';
    });

    search.addEventListener('input', render);
    sort.addEventListener('change', render);
    tagFilter.addEventListener('input', render);

    exportBtn.addEventListener('click', ()=>{
      const data = JSON.stringify(poems, null, 2);
      const blob = new Blob([data],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='poems.json'; a.click(); URL.revokeObjectURL(url);
    });

    importBtn.addEventListener('click', ()=>fileInput.click());
    fileInput.addEventListener('change', async (e)=>{
      const f = e.target.files[0]; if(!f) return; try{const text = await f.text(); const imported = JSON.parse(text); if(Array.isArray(imported)){poems = imported; save(); render(); alert('Imported successfully');} else alert('‡§ó‡§≤‡§§ ‡§´‡§º‡§æ‡§á‡§≤‡•§');}catch(err){alert('Import failed: '+err.message)}
      fileInput.value='';
    });

    // theme
    function setTheme(t){ if(t==='dark'){document.documentElement.setAttribute('data-theme','dark'); themeBtn.textContent='‚òÄÔ∏è'} else {document.documentElement.removeAttribute('data-theme'); themeBtn.textContent='üåô'} localStorage.setItem('poetry_theme',t||'light') }
    themeBtn.addEventListener('click', ()=>{const cur = localStorage.getItem('poetry_theme')==='dark'?'light':'dark'; setTheme(cur)});
    (function(){ if(localStorage.getItem('poetry_theme')==='dark') setTheme('dark'); else setTheme('light'); })();

    // init
    load(); render();
  </script>
</body>
</html>
